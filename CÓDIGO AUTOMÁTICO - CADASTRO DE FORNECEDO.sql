USE P12_PRODUCAO

-->>> CADASTRO DE FORNECEDOR -- PRIMEIRO CÓDIGO DISPONÍVEL <<<--
SELECT TOP 1
    CONVERT(BIGINT,A2_COD)+1 AS A2_COD
FROM SA2070
WHERE CONVERT(BIGINT,A2_COD)+1 NOT IN --NÃO CONTEM NA TABELA EXEMPLO QUE DEVE SER CRIADO AQUI
  (SELECT CONVERT(BIGINT,A2_COD) FROM SA2070 WHERE A2_COD > '000001' AND A2_COD  < '099999' AND D_E_L_E_T_ <> '*' AND LEN(A2_COD) = 6
  ) AND  A2_COD > '000001' AND A2_COD  < '099999' AND D_E_L_E_T_ <> '*' AND LEN(A2_COD) = 6
ORDER BY A2_COD



-->>> CADASTRO DE PRODUTO -- PRIMEIRO CÓDIGO DISPONÍVEL <<<--
SELECT TOP 1
    CONVERT(BIGINT,B1_COD)+1 AS B1_COD
FROM SB1010
WHERE CONVERT(BIGINT,B1_COD)+1 NOT IN --NÃO CONTEM NA TABELA EXEMPLO QUE DEVE SER CRIADO AQUI
  (SELECT CONVERT(BIGINT,B1_COD) FROM SB1010 WHERE B1_COD > '0000005800' AND B1_COD  < '0000099000' AND D_E_L_E_T_ <> '*' AND LEN(B1_COD) = 10
  ) AND  B1_COD > '0000005800' AND B1_COD  < '0000099000' AND D_E_L_E_T_ <> '*' AND LEN(B1_COD) = 10
ORDER BY B1_COD


-->>> TESTE <<<--
DECLARE @EMPRESA1 VARCHAR (2);
DECLARE @TABELA1 VARCHAR (6);
DECLARE @N_LINHAS INT;

SET @TABELA1 = 'SA2010';
SET @EMPRESA1 = SUBSTRING(@TABELA1,4,2);
SET @N_LINHAS = 5

EXECUTE ('SELECT TOP ' + @N_LINHAS + '* FROM '+ @TABELA1)